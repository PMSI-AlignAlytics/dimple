!function(e,i){"use strict";if("object"==typeof exports)module.exports=i(require("d3"));else if("function"==typeof define&&define.amd)define(["d3"],function(t){return e.dimple=i(t),e.dimple});else if(e.d3)e.dimple=i(e.d3);else{if(!console||!console.warn)throw"dimple requires d3 to run.  Are you missing a reference to the d3 library?";console.warn("dimple requires d3 to run.  Are you missing a reference to the d3 library?")}}(this,function(j){"use strict";var R={version:"2.2.0",plot:{},aggregateMethod:{}};return R.axis=function(t,e,i,s,a,r){this.chart=t,this.position=e,this.categoryFields=null==a?i:[].concat(a),this.measure=s,this.timeField=a,this.floatingBarWidth=5,this.hidden=!1,this.showPercent=!1,this.colors=null,this.overrideMin=null,this.overrideMax=null,this.shapes=null,this.showGridlines=null,this.gridlineShapes=null,this.titleShape=null,this.dateParseFormat=null,this.tickFormat=null,this.timePeriod=null,this.timeInterval=1,this.useLog=!1,this.logBase=10,this.title=void 0,this.clamp=!0,this.ticks=null,this.scaleStep=null,this.fontSize="10px",this.fontFamily="sans-serif",this.autoRotateLabel=null==r||r,this._slaves=[],this._scale=null,this._min=0,this._max=0,this._previousOrigin=null,this._origin=null,this._orderRules=[],this._groupOrderRules=[],this._draw=null,this._getAxisData=function(){var t,e,i=[],s=!1;if(this.chart&&this.chart.series){for(t=0;t<this.chart.series.length;t+=1)(e=this.chart.series[t])[this.position]===this&&(e.data&&0<e.data.length?i=i.concat(e.data):s=!0);s&&this.chart.data&&(i=i.concat(this.chart.data))}return i},this._getFontSize=function(){var t=this.fontSize&&"auto"!==this.fontSize.toString().toLowerCase()?isNaN(this.fontSize)?this.fontSize:this.fontSize+"px":(10<this.chart._heightPixels()/35?this.chart._heightPixels()/35:10)+"px";return t},this._getFormat=function(){var t,e,i,s,a=null!==this.tickFormat&&void 0!==this.tickFormat?this._hasTimeField()?j.timeFormat(this.tickFormat):j.format(this.tickFormat):this.showPercent?j.format(".0%"):this.useLog&&null!==this.measure?function(t){var e=Math.floor(Math.abs(t),0).toString().length,e=Math.min(Math.floor((e-1)/3),4),i="kmBT".substring(e-1,e),s="0"===Math.round(t/Math.pow(1e3,e)*10).toString().slice(-1)?0:1;return 0===t?0:j.format(",."+s+"f")(t/Math.pow(1e3,e))+i}:null!==this.measure?(a=Math.floor(Math.abs(this._max),0).toString(),t=Math.floor(Math.abs(this._min),0).toString(),3<(t=Math.max(t.length,a.length))?(e=Math.min(Math.floor((t-1)/3),4),i="kmBT".substring(e-1,e),s=t-3*e<=1?1:0,function(t){return 0===t?0:j.format(",."+s+"f")(t/Math.pow(1e3,e))+i}):(s=Math.max(-(this._tick_step?Math.floor(Math.log(this._tick_step)/Math.LN10):0),0),j.format(",."+s+"f"))):function(t){return t};return a},this._getTimePeriod=function(){var t=this.timePeriod,e=30,i=this._max-this._min;return t=this._hasTimeField()&&!this.timePeriod?i/1e3<=e?j.timeSecond:i/6e4<=e?j.timeMinute:i/36e5<=e?j.timeHour:i/864e5<=e?j.timeHay:i/6048e5<=e?j.timeWeek:i/26298e5<=e?j.timeMonth:j.timeYear:t},this._getTooltipText=function(i,s){if(this._hasTimeField())s[this.position+"Field"][0]&&i.push(this.timeField+": "+this._getFormat()(s[this.position+"Field"][0]));else if(this._hasCategories())this.categoryFields.forEach(function(t,e){null!=t&&s[this.position+"Field"][e]&&i.push(t+(s[this.position+"Field"][e]!==t?": "+s[this.position+"Field"][e]:""))},this);else if(this._hasMeasure())switch(this.position){case"x":i.push(this.measure+": "+this._getFormat()(s.width));break;case"y":i.push(this.measure+": "+this._getFormat()(s.height));break;case"p":i.push(this.measure+": "+this._getFormat()(s.angle)+" ("+j.format(".0%")(s.piePct)+")");break;default:i.push(this.measure+": "+this._getFormat()(s[this.position+"Value"]))}},this._getTopMaster=function(){var t=this;return t=null!==this.master&&void 0!==this.master?this.master._getTopMaster():t},this._hasCategories=function(){return null!==this.categoryFields&&void 0!==this.categoryFields&&0<this.categoryFields.length},this._hasMeasure=function(){return null!==this.measure&&void 0!==this.measure},this._hasTimeField=function(){return null!==this.timeField&&void 0!==this.timeField},this._parseDate=function(t){t=null===this.dateParseFormat||void 0===this.dateParseFormat?isNaN(t)?Date.parse(t):new Date(t):j.timeParse(this.dateParseFormat)(t);return t},this._update=function(t){function e(e,i,s){for(var t,a,r=e.categoryFields[0],n=e._getAxisData(),o=r,l=!1,h=!0,c=0;c<n.length;c+=1)if(null!=(t=e._parseDate(n[c][r]))&&isNaN(t)){h=!1;break}return h||e.chart.series.forEach(function(t){t[i]===e&&t[s]._hasMeasure()&&(o=t[s].measure,l=!0)},this),a=e._orderRules.concat({ordering:o,desc:l}),R._getOrderedList(n,r,a)}var i=[],s=this.ticks||10,a=(this._min=this.showPercent&&this._min<-1?-1:this._min,this._max=this.showPercent&&1<this._max?1:this._max,this._min=null!==this.overrideMin?this.overrideMin:this._min,this._max=null!==this.overrideMax?this.overrideMax:this._max,()=>{var{_draw:t,_scale:e,scaleStep:i}=this;i&&t&&e&&([t,e]=e.domain(),(t=j.range(t,e,i))[t.length-1]+i===e&&t.push(e),t.length<=200)&&this._draw.tickValues(t)});if("x"!==this.position||null!==this._scale&&!t){if("y"!==this.position||null!==this._scale&&!t)0<this.position.length&&"z"===this.position[0]&&null===this._scale?this.useLog?this._scale=j.scaleLog().range([this.chart._heightPixels()/300,this.chart._heightPixels()/10]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase):this._scale=j.scaleLinear().range([1,this.chart._heightPixels()/10]).domain([this._min,this._max]).clamp(this.clamp):0<this.position.length&&"p"===this.position[0]&&null===this._scale?this.useLog?this._scale=j.scaleLog().range([0,360]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase):this._scale=j.scaleLinear().range([0,360]).domain([this._min,this._max]).clamp(this.clamp):0<this.position.length&&"c"===this.position[0]&&null===this._scale&&(this._scale=j.scaleLinear().range([0,null===this.colors||1===this.colors.length?1:this.colors.length-1]).domain([this._min,this._max]).clamp(this.clamp));else if(this._hasTimeField()?this._scale=j.scaleTime().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain([this._min,this._max]).clamp(this.clamp):this.useLog?this._scale=j.scaleLog().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase).nice():null===this.measure||void 0===this.measure?(i=e(this,"y","x"),null!==this._slaves&&void 0!==this._slaves&&this._slaves.forEach(function(t){i=i.concat(e(t,"y","x"))},this),this._scale=j.scalePoint().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain(i.concat([""]))):this._scale=j.scaleLinear().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain([this._min,this._max]).clamp(this.clamp).nice(),!this.hidden){switch(this.chart._axisIndex(this,"y")){case 0:this._draw=j.axisLeft().scale(this._scale),this.ticks&&this._draw.ticks(s);break;case 1:this._draw=j.axisRight().scale(this._scale),this.ticks&&this._draw.ticks(s)}a()}}else if(this._hasTimeField()?this._scale=j.scaleTime().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain([this._min,this._max]).clamp(this.clamp):this.useLog?this._scale=j.scaleLog().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase).nice():null===this.measure||void 0===this.measure?(i=e(this,"x","y"),null!==this._slaves&&void 0!==this._slaves&&this._slaves.forEach(function(t){i=i.concat(e(t,"x","y"))},this),this._scale=j.scalePoint().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain(i.concat([""]))):this._scale=j.scaleLinear().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain([this._min,this._max]).clamp(this.clamp).nice(),!this.hidden){switch(this.chart._axisIndex(this,"x")){case 0:this._draw=j.axisBottom().scale(this._scale),this.ticks&&this._draw.ticks(s);break;case 1:this._draw=j.axisTop().scale(this._scale),this.ticks&&this._draw.ticks(s)}a()}return null!==this._slaves&&void 0!==this._slaves&&0<this._slaves.length&&this._slaves.forEach(function(t){t._scale=this._scale},this),null!=t&&!1!==t||this._hasTimeField()||null===this._scale||null===this._scale.ticks||void 0===this._scale.ticks||!(0<this._scale.ticks(s).length)||"x"!==this.position&&"y"!==this.position||(t=(a=this._scale.ticks(s))[1]-a[0],a=((this._max-this._min)%t).toFixed(0),this._tick_step=t,0!==a&&(this._max=Math.ceil(this._max/t)*t,this._min=Math.floor(this._min/t)*t,this._update(!0))),a=null!=i&&0<i.length?this._scale.copy()(i[0]):0<this._min?this._scale.copy()(this._min):this._max<0?this._scale.copy()(this._max):this._scale.copy()(0),this._origin!==a&&(this._previousOrigin=null===this._origin?a:this._origin,this._origin=a),this},this.addGroupOrderRule=function(t,e){this._groupOrderRules.push({ordering:t,desc:e})},this.addOrderRule=function(t,e){this._orderRules.push({ordering:t,desc:e})}},R.chart=function(t,e){this.svg=t,this.x="10%",this.y="10%",this.width="80%",this.height="80%",this.data=e,this.noFormats=!1,this.axes=[],this.series=[],this.legends=[],this.storyboard=null,this.titleShape=null,this.shapes=null,this.ease=j.easeCubicInOut,this.staggerDraw=!1,this.transition={},this._group=t.append("g"),this._group.attr("class","dimple-chart"),this._gridlines_group=this._group.insert("g"),this._gridlines_group.attr("class","dimple-gridlines-group"),this._axis_group=this._group.insert("g"),this._axis_group.attr("class","dimple-axis-group"),this._tooltipGroup=null,this._assignedColors={},this._assignedClasses={},this._nextColor=0,this._nextClass=0,this._axisIndex=function(t,e){for(var i=0,s=0,a=-1,i=0;i<this.axes.length;i+=1){if(this.axes[i]===t){a=s;break}null!=e&&e[0]!==this.axes[i].position[0]||(s+=1)}return a},this._getAllData=function(){var e=[];return null!==this.data&&void 0!==this.data&&0<this.data.length&&(e=e.concat(this.data)),null!==this.series&&void 0!==this.series&&0<this.series.length&&this.series.forEach(function(t){null!==t.data&&void 0!==t.data&&0<t.data.length&&(e=e.concat(t.data))}),e},this._getData=function(t,c,u,e,l,d,p,g,_,f){function x(t,e){var i=[];return null!==t&&(t._hasTimeField()?i.push(t._parseDate(e[t.timeField])):t._hasCategories()&&t.categoryFields.forEach(function(t){i.push(e[t])},this)),i}var i,s,y=[],m={x:!1,y:!1,z:!1,p:!1,c:!1},h={x:[],y:[]},v={x:[],y:[],z:[],p:[]},a={min:null,max:null},F={x:[],y:[],z:[],p:[]},k=[],w={},C={x:0,y:0,z:0,p:0},b="",P=[],B=[],S=[],M="",L=[],T="",z=[],O="",V=[],r=[],n=t,t=[];for(s in this.storyboard&&0<this.storyboard.categoryFields.length&&(b=this.storyboard.categoryFields[0],P=R._getOrderedList(n,b,this.storyboard._orderRules)),d&&d._hasCategories()&&d._hasMeasure()&&(M=d.categoryFields[0],L=R._getOrderedList(n,M,d._orderRules.concat([{ordering:d.measure,desc:!0}]))),p&&p._hasCategories()&&p._hasMeasure()&&(T=p.categoryFields[0],z=R._getOrderedList(n,T,p._orderRules.concat([{ordering:p.measure,desc:!0}]))),_&&_._hasCategories()&&_._hasMeasure()&&(O=_.categoryFields[0],V=R._getOrderedList(n,O,_._orderRules.concat([{ordering:_.measure,desc:!0}]))),0<n.length&&c&&0<c.length&&(r=[].concat(e),B=[],c.forEach(function(t){void 0!==n[0][t]&&B.push(t)},this),_&&_._hasMeasure()?r.push({ordering:_.measure,desc:!0}):f&&f._hasMeasure()?r.push({ordering:f.measure,desc:!0}):g&&g._hasMeasure()?r.push({ordering:g.measure,desc:!0}):d&&d._hasMeasure()?r.push({ordering:d.measure,desc:!0}):p&&p._hasMeasure()&&r.push({ordering:p.measure,desc:!0}),S=R._getOrderedList(n,B,r)),n.sort(function(t,e){var i,s,a,r,n,o,l=0;if(""!==b&&(l=P.indexOf(t[b])-P.indexOf(e[b])),""!==M&&0===l&&(l=L.indexOf(t[M])-L.indexOf(e[M])),""!==T&&0===l&&(l=z.indexOf(t[T])-z.indexOf(e[T])),""!==O&&0===l&&(l=V.indexOf(t[O])-z.indexOf(e[O])),B&&0<B.length&&0===l)for(i=[].concat(B),a=l=0;a<S.length;a+=1){for(s=[].concat(S[a]),o=n=!0,r=0;r<i.length;r+=1)n=n&&t[i[r]]===s[r],o=o&&e[i[r]]===s[r];if(n||o){l=n&&o?0:n?-1:1;break}}return l}),n.forEach(function(o){var t,e,i,l=-1,s=x(d,o),a=x(p,o),r=x(g,o),n=x(_,o),h=[];if(c&&0!==c.length)for(i=0;i<c.length;i+=1)void 0===o[c[i]]?h.push(c[i]):h.push(o[c[i]]);else h=["All"];for(t=h.join("/")+"_"+s.join("/")+"_"+a.join("/")+"_"+n.join("/")+"_"+r.join("/"),e=0;e<y.length;e+=1)if(y[e].key===t){l=e;break}-1===l&&(y.push({key:t,aggField:h,xField:s,xValue:null,xCount:0,yField:a,yValue:null,yCount:0,pField:n,pValue:null,pCount:0,zField:r,zValue:null,zCount:0,cValue:0,cCount:0,x:0,y:0,xOffset:0,yOffset:0,width:0,height:0,cx:0,cy:0,xBound:0,yBound:0,xValueList:[],yValueList:[],zValueList:[],pValueList:[],cValueList:[],fill:{},stroke:{}}),l=y.length-1),(s=function(t,e){var i,s=!0,a={value:0,count:1},r={value:0,count:1},n="";null!==e&&(i=e.getFrameValue(),e.categoryFields.forEach(function(t,e){0<e&&(n+="/"),n+=o[t],s=n===i},this)),null!=t&&s&&(e=y[l],t._hasMeasure())&&null!==o[t.measure]&&void 0!==o[t.measure]&&(-1===e[t.position+"ValueList"].indexOf(o[t.measure])&&e[t.position+"ValueList"].push(o[t.measure]),isNaN(parseFloat(o[t.measure]))&&(m[t.position]=!0),a.value=e[t.position+"Value"],a.count=e[t.position+"Count"],r.value=o[t.measure],e[t.position+"Value"]=u(a,r),e[t.position+"Count"]+=1)})(d,this.storyboard),s(p,this.storyboard),s(g,this.storyboard),s(_,this.storyboard),s(f,this.storyboard)},this),d&&d._hasCategories()&&1<d.categoryFields.length&&void 0!==h.x&&(t=[],p._hasMeasure()&&t.push({ordering:p.measure,desc:!0}),h.x=R._getOrderedList(n,d.categoryFields[1],d._groupOrderRules.concat(t))),p&&p._hasCategories()&&1<p.categoryFields.length&&void 0!==h.y&&(t=[],d._hasMeasure()&&t.push({ordering:d.measure,desc:!0}),h.y=R._getOrderedList(n,p.categoryFields[1],p._groupOrderRules.concat(t)),h.y.reverse()),y.forEach(function(t){null!==d&&(!0===m.x&&(t.xValue=t.xValueList.length),i=d._hasMeasure()&&d._hasCategories()?(v.x[t.xField.join("/")]||0)+(d._hasMeasure()?Math.abs(t.xValue):0):(v.x[t.xField.join("/")]||0)+(p._hasMeasure()?Math.abs(t.yValue):0),v.x[t.xField.join("/")]=i),null!==p&&(!0===m.y&&(t.yValue=t.yValueList.length),i=p._hasMeasure()&&p._hasCategories()?(v.y[t.yField.join("/")]||0)+(p._hasMeasure()?Math.abs(t.yValue):0):(v.y[t.yField.join("/")]||0)+(d._hasMeasure()?Math.abs(t.xValue):0),v.y[t.yField.join("/")]=i),null!==_&&(!0===m.p&&(t.pValue=t.pValueList.length),i=(v.p[t.pField.join("/")]||0)+(_._hasMeasure()?Math.abs(t.pValue):0),v.p[t.pField.join("/")]=i),null!==g&&(!0===m.z&&(t.zValue=t.zValueList.length),i=(v.z[t.zField.join("/")]||0)+(g._hasMeasure()?Math.abs(t.zValue):0),v.z[t.zField.join("/")]=i),null!==f&&((null===a.min||t.cValue<a.min)&&(a.min=t.cValue),null===a.max||t.cValue>a.max)&&(a.max=t.cValue)},this),v.x)v.x.hasOwnProperty(s)&&(C.x+=v.x[s]);for(s in v.y)v.y.hasOwnProperty(s)&&(C.y+=v.y[s]);for(s in v.p)v.p.hasOwnProperty(s)&&(C.p+=v.p[s]);for(s in v.z)v.z.hasOwnProperty(s)&&(C.z+=v.z[s]);return y.forEach(function(o){function t(t,e,i){var s,a,r,n;null!=t&&(n=t.position,t._hasCategories()?t._hasMeasure()?(s=o[t.position+"Field"].join("/"),a=t.showPercent?v[t.position][s]/C[t.position]:v[t.position][s],-1===k.indexOf(s)&&(w[s]=a+(0<k.length?w[k[k.length-1]]:0),k.push(s)),r=o[n+"Bound"]=o["c"+n]="x"!==n&&"y"!==n||!l?a:w[s],o[i]=a,o[n]=r-("x"===n&&0<=a||"y"===n&&a<=0?a:0)):(o[n]=o["c"+n]=o[n+"Field"][0],o[i]=1,null!=h[n]&&2<=h[n].length&&(o[n+"Offset"]=h[n].indexOf(o[n+"Field"][1]),o[i]=1/h[n].length)):(a=t.showPercent?o[n+"Value"]/v[e][o[e+"Field"].join("/")]:o[n+"Value"],s=o[e+"Field"].join("/")+(0<=o[n+"Value"]),t=F[n][s]=(null===F[n][s]||void 0===F[n][s]||"z"===n||"p"===n?0:F[n][s])+a,r=o[n+"Bound"]=o["c"+n]="x"!==n&&"y"!==n||!l?a:t,o[i]=a,o[n]=r-("x"===n&&0<=a||"y"===n&&a<=0?a:0)))}var e,i,s;t(d,"y","width"),t(p,"x","height"),t(g,"z","r"),t(_,"p","angle"),null!==f&&null!==a.min&&null!==a.max&&(a.min===a.max&&(a.min-=.5,a.max+=.5),a.min=f.overrideMin||a.min,a.max=f.overrideMax||a.max,o.cValue=o.cValue>a.max?a.max:o.cValue<a.min?a.min:o.cValue,s=(i=j.scaleLinear().range([0,null===f.colors||1===f.colors.length?1:f.colors.length-1]).domain([a.min,a.max])(o.cValue))-Math.floor(i),o.cValue===a.max&&(s=1),i=f.colors&&1===f.colors.length?(e=j.rgb(f.colors[0]),j.rgb(this.getColor(o.aggField.slice(-1)[0]).fill)):f.colors&&1<f.colors.length?(e=j.rgb(f.colors[Math.floor(i)]),j.rgb(f.colors[Math.ceil(i)])):(e=j.rgb("white"),j.rgb(this.getColor(o.aggField.slice(-1)[0]).fill)),e.r=Math.floor(e.r+(i.r-e.r)*s),e.g=Math.floor(e.g+(i.g-e.g)*s),e.b=Math.floor(e.b+(i.b-e.b)*s),o.fill=e.toString(),o.stroke=e.darker(.5).toString())},this),y},this._getDelay=function(i,s,a){return function(t){var e=0;return a&&s.staggerDraw&&(a.x._hasCategories()?e=R._helpers.cx(t,s,a)/s._widthPixels()*i:a.y._hasCategories()&&(e=(1-R._helpers.cy(t,s,a)/s._heightPixels())*i)),e}},this._getSeriesData=function(){null!==this.series&&void 0!==this.series&&this.series.forEach(function(t){var e,i,s,a,r,n,o=t.data||this.data||[],l=[].concat(t.categoryFields||"All"),h=this._getData(o,l,t.aggregate,t._orderRules,t._isStacked(),t.x,t.y,t.z,t.p,t.c),c={},u=t.startAngle*(Math.PI/180)||0,d=(t.endAngle||360)*(Math.PI/180);if(d<u&&(u-=2*Math.PI),t.p&&0<l.length){if(t.x&&t.y){for(l.pop(),e=this._getData(o,["__dimple_placeholder__"].concat(l),t.aggregate,t._orderRules,t._isStacked(),t.x,t.y,t.z,t.p,t.c),i=0;i<h.length;i+=1)for((a=["__dimple_placeholder__"].concat(h[i].aggField)).pop(),t.x&&t.x._hasCategories()&&(a=a.concat(h[i].xField)),r=(a=t.y&&t.y._hasCategories()?a.concat(h[i].yField):a).join("|"),s=0;s<e.length;s+=1)if(n=[].concat(e[s].aggField),t.x&&t.x._hasCategories()&&(n=n.concat(e[s].xField)),r===(n=t.y&&t.y._hasCategories()?n.concat(e[s].yField):n).join("|")){h[i].xField=e[s].xField,h[i].xValue=e[s].xValue,h[i].xCount=e[s].xCount,h[i].yField=e[s].yField,h[i].yValue=e[s].yValue,h[i].yCount=e[s].yCount,h[i].zField=e[s].zField,h[i].zValue=e[s].zValue,h[i].zCount=e[s].zCount,h[i].x=e[s].x,h[i].y=e[s].y,h[i].r=e[s].r,h[i].xOffset=e[s].xOffset,h[i].yOffset=e[s].yOffset,h[i].width=e[s].width,h[i].height=e[s].height,h[i].cx=e[s].cx,h[i].cy=e[s].cy,h[i].xBound=e[s].xBound,h[i].yBound=e[s].yBound,h[i].xValueList=e[s].xValueList,h[i].yValueList=e[s].yValueList,h[i].zValueList=e[s].zValueList,h[i].cValueList=e[s].cValueList,h[i].pieKey=e[s].key,h[i].value=h.pValue,c[e[s].key]||(c[e[s].key]={total:0,angle:u}),c[e[s].key].total+=h[i].pValue;break}}else for(i=0;i<h.length;i+=1)h[i].pieKey="All",h[i].value=h.pValue,c[h[i].pieKey]||(c[h[i].pieKey]={total:0,angle:u}),c[h[i].pieKey].total+=h[i].pValue;for(i=0;i<h.length;i+=1)0===c[h[i].pieKey].total?h[i].piePct=0:h[i].piePct=h[i].pValue/c[h[i].pieKey].total,h[i].startAngle=c[h[i].pieKey].angle,h[i].endAngle=h[i].startAngle+h[i].piePct*(d-u),c[h[i].pieKey].angle=h[i].endAngle}t._positionData=h},this)},this._handleTransition=function(t,e,i,s){var a=null;return 0===e?a=t:(a=t.transition().duration(e).delay(i._getDelay(e,i,s)),R._ease(a,i.ease)),a},this._heightPixels=function(){return R._parseYPosition(this.height,this.svg.node())},this._registerEventHandlers=function(s){null!==s._eventHandlers&&0<s._eventHandlers.length&&s._eventHandlers.forEach(function(i){function t(t){var e=new R.eventArgs;null!==s.chart.storyboard&&(e.frameValue=s.chart.storyboard.getFrameValue()),e.seriesValue=t.aggField,e.xValue=t.x,e.yValue=t.y,e.zValue=t.z,e.pValue=t.p,e.colorValue=t.cValue,e.seriesShapes=s.shapes,e.selectedShape=j.select(this),i.handler(e)}if(null!==i.handler&&"function"==typeof i.handler)if(null!==s._markers&&void 0!==s._markers)for(var e in s._markers)s._markers.hasOwnProperty(e)&&s._markers[e].on(i.event,t);else s.shapes.on(i.event,t)},this)},this._widthPixels=function(){return R._parseXPosition(this.width,this.svg.node())},this._xPixels=function(){return R._parseXPosition(this.x,this.svg.node())},this._yPixels=function(){return R._parseYPosition(this.y,this.svg.node())},this.addAxis=function(t,e,i,s){var a,r=null,n=null;if(null!=e&&(e=[].concat(e)),"string"==typeof t||t instanceof String)r=new R.axis(this,t,e,i,s),this.axes.push(r);else{if((r=new R.axis(this,(n=t).position,e,i,s))._hasMeasure()!==n._hasMeasure()?a="You have specified a composite axis where some but not all axes have a measure - this is not supported, all axes must be of the same type.":r._hasTimeField()!==n._hasTimeField()?a="You have specified a composite axis where some but not all axes have a time field - this is not supported, all axes must be of the same type.":(null===r.categoryFields||void 0===r.categoryFields?0:r.categoryFields.length)!==(null===n.categoryFields||void 0===n.categoryFields?0:n.categoryFields.length)&&(a="You have specified a composite axis where axes have differing numbers of category fields - this is not supported, all axes must be of the same type."),a)throw a;n._slaves.push(r)}return r},this.addCategoryAxis=function(t,e){return this.addAxis(t,e,null)},this.addColorAxis=function(t,e){t=this.addAxis("c",null,t);return t.colors=null==e?null:[].concat(e),t},this.addLegend=function(t,e,i,s,a,r){r=null==r?this.series:[].concat(r);t=new R.legend(this,t,e,i,s,a=null==a?"left":a,r);return this.legends.push(t),t},this.addLogAxis=function(t,e,i){t=this.addAxis(t,null,e,null);return null!=i&&(t.logBase=i),t.useLog=!0,t},this.addMeasureAxis=function(t,e){return this.addAxis(t,null,e)},this.addPctAxis=function(t,e,i){var s=null;return(s=null!=i?this.addAxis(t,i,e):this.addMeasureAxis(t,e)).showPercent=!0,s},this.addSeries=function(t,e,i){null==i&&(i=this.axes),null==e&&(e=R.plot.bubble);var s=null,a=null,r=null,n=null,o=null;return i.forEach(function(t){null!==t&&-1<e.supportedAxes.indexOf(t.position)&&(null===s&&"x"===t.position[0]?s=t:null===a&&"y"===t.position[0]?a=t:null===r&&"z"===t.position[0]?r=t:null===n&&"c"===t.position[0]?n=t:null===n&&"p"===t.position[0]&&(o=t))},this),t=t&&[].concat(t),i=new R.series(this,t,s,a,r,n,o,e,R.aggregateMethod.sum,e.stacked),this.series.push(i),i},this.addTimeAxis=function(t,e,i,s){t=this.addAxis(t,null,null,e);return t.tickFormat=s,t.dateParseFormat=i,t},this.assignClass=function(t,e){return this._assignedClasses[t]=e,this._assignedClasses[t]},this.assignColor=function(t,e,i,s){return this._assignedColors[t]=new R.color(e,i,s),this._assignedColors[t]},this.customClassList={axisLine:"dimple-custom-axis-line",axisLabel:"dimple-custom-axis-label",axisTitle:"dimple-custom-axis-title",tooltipBox:"dimple-custom-tooltip-box",tooltipLabel:"dimple-custom-tooltip-label",tooltipDropLine:"dimple-custom-tooltip-dropline",lineMarker:"dimple-custom-line-marker",lineMarkerCircle:"dimple-custom-line-marker-circle",legendLabel:"dimple-custom-legend-label",legendKey:"dimple-custom-legend-key",areaSeries:"dimple-custom-series-area",barSeries:"dimple-custom-series-bar",bubbleSeries:"dimple-custom-series-bubble",lineSeries:"dimple-custom-series-line",pieSeries:"dimple-custom-series-pie",gridline:"dimple-custom-gridline",colorClasses:["dimple-custom-format-1","dimple-custom-format-2","dimple-custom-format-3","dimple-custom-format-4","dimple-custom-format-5","dimple-custom-format-6","dimple-custom-format-7","dimple-custom-format-8","dimple-custom-format-9","dimple-custom-format-10"]},this.defaultColors=[new R.color("#80B1D3"),new R.color("#FB8072"),new R.color("#FDB462"),new R.color("#B3DE69"),new R.color("#FFED6F"),new R.color("#BC80BD"),new R.color("#8DD3C7"),new R.color("#CCEBC5"),new R.color("#FFFFB3"),new R.color("#BEBADA"),new R.color("#FCCDE5"),new R.color("#D9D9D9")],this.draw=function(_,t){_=_||0;var s,a,f=null,x=null,y=!1,m=!1,v=this._xPixels(),F=this._yPixels(),k=this._widthPixels(),w=this._heightPixels();return null!=t&&!1!==t||this._getSeriesData(),this.axes.forEach(function(t){t._scale=null},this),this.axes.forEach(function(i){var e;i._min=0,i._max=0,a=[],i._hasMeasure()?(e=!1,this.series.forEach(function(t){t._deepMatch(i)&&(t=t._axisBounds(i.position),i._min>t.min&&(i._min=t.min),i._max<t.max&&(i._max=t.max),e=!0)},this),e||this._getAllData().forEach(function(t){i._min>t[i.measure]&&(i._min=t[i.measure]),i._max<t[i.measure]&&(i._max=t[i.measure])},this)):i._hasTimeField()?(i._min=null,i._max=null,this.series.forEach(function(t){t._deepMatch(i)&&null!==t[i.position].timeField&&void 0!==t[i.position].timeField&&-1===a.indexOf(t[i.position].timeField)&&a.push(t[i.position].timeField)},this),i._getAxisData().forEach(function(e){a.forEach(function(t){t=i._parseDate(e[t]);(null===i._min||t<i._min)&&(i._min=t),(null===i._max||t>i._max)&&(i._max=t)},this)},this)):i._hasCategories()&&(i._min=0,s=[],this.series.forEach(function(t){t._deepMatch(i)&&null!==t[i.position].categoryFields[0]&&void 0!==t[i.position].categoryFields[0]&&-1===a.indexOf(t[i.position].categoryFields[0])&&a.push(t[i.position].categoryFields[0])},this),i._getAxisData().forEach(function(e){a.forEach(function(t){-1===s.indexOf(e[t])&&s.push(e[t])},this)},this),i._max=s.length),null!==i._slaves&&void 0!==i._slaves&&0<i._slaves.length&&i._slaves.forEach(function(t){t._min=i._min,t._max=i._max},this),i._update(),null===f&&"x"===i.position?f=i:null===x&&"y"===i.position&&(x=i)},this),this.axes.forEach(function(e){function t(t){return t=null===r||0===_||a?t:g._handleTransition(t,_,g)}function i(){var t=j.select(this).selectAll("text");return!e.measure&&0<e._max&&("x"===e.position?t.attr("x",k/e._max/2):"y"===e.position&&t.attr("y",w/e._max*-1/2)),e.categoryFields&&0<e.categoryFields.length&&(e!==f||null!==x.categoryFields&&0!==x.categoryFields.length||t.attr("y",F+w-x._scale(0)+9),e!==x||null!==f.categoryFields&&0!==f.categoryFields.length||t.attr("x",-1*(f._scale(0)-v)-9)),this}function s(e){return function(){var t=j.select(this).attr("class")||"";return-1===t.indexOf(e)&&(t+=" "+e),t.trim()}}var a=!1,r=null,n=0,o=null,l=!1,h=0,c={l:null,t:null,r:null,b:null},u=0,d=0,p="",g=this;null===e.gridlineShapes?(e.showGridlines||null===e.showGridlines&&!e._hasCategories()&&(!y&&"x"===e.position||!m&&"y"===e.position))&&(e.gridlineShapes=this._gridlines_group.append("g").attr("class","dimple-gridline"),"x"===e.position?y=!0:m=!0):"x"===e.position?y=!0:m=!0,null===e.shapes&&(e.shapes=this._axis_group.append("g").attr("class","dimple-axis dimple-axis-"+e.position).each(function(){g.noFormats||j.select(this).style("font-family",e.fontFamily).style("font-size",e._getFontSize())}),a=!0),e===f&&null!==x?(r="translate(0, "+(null===x.categoryFields||0===x.categoryFields.length?x._scale(0):F+w)+")",o="translate(0, "+(e===f?F+w:F)+")",n=-w):e===x&&null!==f?(r="translate("+(null===f.categoryFields||0===f.categoryFields.length?f._scale(0):v)+", 0)",o="translate("+(e===x?v:v+k)+", 0)",n=-k):"x"===e.position?(o=r="translate(0, "+(e===f?F+w:F)+")",n=-w):"y"===e.position&&(o=r="translate("+(e===x?v:v+k)+", 0)",n=-k),null!==r&&null!==e._draw&&((e._hasTimeField()?t(e.shapes).call(e._draw.ticks(e._getTimePeriod(),e.timeInterval).tickFormat(e._getFormat())):e.useLog?t(e.shapes).call(e._draw.ticks(4,e._getFormat())):t(e.shapes).call(e._draw.tickFormat(e._getFormat()))).attr("transform",r).each(i),null!==e.gridlineShapes)&&t(e.gridlineShapes).call(e._draw.tickSize(n,0,0).tickFormat("")).attr("transform",o),t(e.shapes.selectAll("text")).attr("class",s(g.customClassList.axisLabel)).call(function(t){g.noFormats||t.style("font-family",e.fontFamily).style("font-size",e._getFontSize())}),t(e.shapes.selectAll("path, line")).attr("class",s(g.customClassList.axisLine)).call(function(t){g.noFormats||t.style("fill","none").style("stroke","black").style("shape-rendering","crispEdges")}),null!==e.gridlineShapes&&(e.gridlineShapes.selectAll("path").remove(),t(e.gridlineShapes.selectAll("line")).attr("class",s(g.customClassList.gridline)).call(function(t){g.noFormats||t.style("fill","none").style("stroke","lightgray").style("opacity",.8)})),null!==e.measure&&void 0!==e.measure||(e.autoRotateLabel?e===f?(h=0,e.shapes.selectAll("text").each(function(){var t=e.maxTextWidth||this.getComputedTextLength();h=h<t?t:h}),h>(e._scale.step?e._scale.step():k/e.shapes.selectAll("text").nodes().length)?(l=!0,e.shapes.selectAll("text").style("text-anchor","start").each(function(){var t=this.getBBox();j.select(this).attr("transform","rotate(90,"+t.x+","+(t.y+t.height/2)+") translate(-5, 0)")})):(l=!1,e.shapes.selectAll("text").style("text-anchor","middle").attr("transform",""))):"x"===e.position&&(h=0,e.shapes.selectAll("text").each(function(){var t=this.getComputedTextLength();h=h<t?t:h}),h>k/e.shapes.selectAll("text").nodes().length?(l=!0,e.shapes.selectAll("text").style("text-anchor","end").each(function(){var t=this.getBBox();j.select(this).attr("transform","rotate(90,"+(t.x+t.width)+","+(t.y+t.height/2)+") translate(5, 0)")})):(l=!1,e.shapes.selectAll("text").style("text-anchor","middle").attr("transform",""))):(l=!1,e.shapes.selectAll("text").style("text-anchor","middle").attr("transform",""))),null!==e.titleShape&&void 0!==e.titleShape&&e.titleShape.remove(),e.shapes.selectAll("text").each(function(){var t=this.getBBox();(null===c.l||-9-t.width<c.l)&&(c.l=-9-t.width),(null===c.r||t.x+t.width>c.r)&&(c.r=t.x+t.width),l?((null===c.t||t.y+t.height-t.width<c.t)&&(c.t=t.y+t.height-t.width),(null===c.b||t.height+t.width>c.b)&&(c.b=(e.maxTextWidth?20:t.height)+t.width)):((null===c.t||t.y<c.t)&&(c.t=t.y),(null===c.b||9+t.height>c.b)&&(c.b=9+t.height))}),"x"===e.position?(d=e===f?F+w+c.b+5:F+c.t-10,u=v+k/2):"y"===e.position&&(p="rotate(270, "+(u=e===x?v+c.l-10:v+k+c.r+20)+", "+(d=F+w/2)+")"),e.hidden||"x"!==e.position&&"y"!==e.position||null===e.title||(e.titleShape=this._axis_group.append("text").attr("class","dimple-axis dimple-title "+g.customClassList.axisTitle+" dimple-axis-"+e.position),e.titleShape.attr("x",u).attr("y",d).attr("text-anchor","middle").attr("transform",p).text(void 0!==e.title?e.title:null===e.categoryFields||void 0===e.categoryFields||0===e.categoryFields.length?e.measure:e.categoryFields.join("/")).each(function(){g.noFormats||j.select(this).style("font-family",e.fontFamily).style("font-size",e._getFontSize())}),e===f?e.titleShape.each(function(){j.select(this).attr("y",d+this.getBBox().height/1.65)}):e===x&&e.titleShape.each(function(){j.select(this).attr("x",u+this.getBBox().height/1.65)}))},this),this.series.forEach(function(t){t.plot.draw(this,t,_),this._registerEventHandlers(t)},this),this.legends.forEach(function(t){t._draw()},this),this.storyboard&&(this.storyboard._drawText(),this.storyboard.autoplay)&&this.storyboard.startAnimation(),this},this.getClass=function(t){return this._assignedClasses[t]||(this._assignedClasses[t]=this.customClassList.colorClasses[this._nextClass],this._nextClass=(this._nextClass+1)%this.customClassList.colorClasses.length),this._assignedClasses[t]},this.getColor=function(t){return null!==this._assignedColors[t]&&void 0!==this._assignedColors[t]||(this._assignedColors[t]=this.defaultColors[this._nextColor],this._nextColor=(this._nextColor+1)%this.defaultColors.length),this._assignedColors[t]},this.setBounds=function(t,e,i,s){return this.x=t,this.y=e,this.width=i,this.height=s,this._xPixels=function(){return R._parseXPosition(this.x,this.svg.node())},this.draw(0,!0),this._yPixels=function(){return R._parseYPosition(this.y,this.svg.node())},this._widthPixels=function(){return R._parseXPosition(this.width,this.svg.node())},this._heightPixels=function(){return R._parseYPosition(this.height,this.svg.node())},this},this.setMargins=function(t,e,i,s){return this.x=t,this.y=e,this.width=0,this.height=0,this._xPixels=function(){return R._parseXPosition(this.x,this.svg.node())},this._yPixels=function(){return R._parseYPosition(this.y,this.svg.node())},this._widthPixels=function(){return R._parentWidth(this.svg.node())-this._xPixels()-R._parseXPosition(i,this.svg.node())},this._heightPixels=function(){return R._parentHeight(this.svg.node())-this._yPixels()-R._parseYPosition(s,this.svg.node())},this},this.setStoryboard=function(t,e){return this.storyboard=new R.storyboard(this,t),null!=e&&(this.storyboard.onTick=e),this.storyboard}},R.color=function(t,e,i){this.fill=t,this.stroke=null==e?j.rgb(t).darker(.5).toString():e,this.opacity=null==i?.8:i},R.eventArgs=function(){this.seriesValue=null,this.xValue=null,this.yValue=null,this.zValue=null,this.pValue=null,this.colorValue=null,this.frameValue=null,this.seriesShapes=null,this.selectedShape=null},R.legend=function(t,e,i,s,a,r,n){this.chart=t,this.series=n,this.x=e,this.y=i,this.width=s,this.height=a,this.horizontalAlign=r,this.shapes=null,this.fontSize="10px",this.fontFamily="sans-serif",this._draw=function(){var t=this._getEntries(),i=0,s=0,a=0,r=0,n=this;this.shapes&&this.shapes.remove(),(t=this.chart._group.selectAll(".dimple-dont-select-any").data(t).enter().append("g").attr("class",function(t){return"dimple-legend "+R._createClass(t.aggField)}).attr("opacity",1)).append("text").attr("class",function(t){return"dimple-legend dimple-legend-text "+R._createClass(t.aggField)+" "+n.chart.customClassList.legendLabel}).text(function(t){return t.key}).call(function(t){n.chart.noFormats||t.style("font-family",n.fontFamily).style("font-size",n._getFontSize()).style("shape-rendering","crispEdges")}).each(function(){var t=this.getBBox();t.width>i&&(i=t.width),t.height>s&&(s=t.height)}),t.append("rect").attr("class",function(t){return"dimple-legend dimple-legend-key "+R._createClass(t.aggField)}).attr("height",9).attr("width",15),s=(s<9?9:s)+n._getVerticalPadding(),i+=15+n._getHorizontalPadding(),t.each(function(e){a+i>n._widthPixels()&&(a=0,r+=s),r>n._heightPixels()?j.select(this).remove():(j.select(this).select("text").attr("x","left"===n.horizontalAlign?n._xPixels()+15+5+a:n._xPixels()+(n._widthPixels()-a-i)+15+5).attr("y",function(){return n._yPixels()+r+this.getBBox().height/1.65}).attr("width",n._widthPixels()).attr("height",n._heightPixels()),j.select(this).select("rect").attr("class",function(t){return"dimple-legend dimple-legend-key "+R._createClass(t.aggField)+" "+n.chart.customClassList.legendKey+" "+t.css}).attr("x","left"===n.horizontalAlign?n._xPixels()+a:n._xPixels()+(n._widthPixels()-a-i)).attr("y",n._yPixels()+r).attr("height",9).attr("width",15).call(function(t){n.chart.noFormats||t.style("fill",e.fill).style("stroke",e.stroke).style("opacity",e.opacity).style("shape-rendering","crispEdges")}),a+=i)}),this.shapes=t},this._getEntries=function(){var r=[];return this.series&&this.series.forEach(function(a){a._positionData.forEach(function(t){for(var e=-1,i=a.plot.grouped&&!a.x._hasCategories()&&!a.y._hasCategories()&&t.aggField.length<2?"All":t.aggField.slice(-1)[0],s=0;s<r.length;s+=1)if(r[s].key===i){e=s;break}-1===e&&a.chart._assignedColors[i]&&r.push({key:i,fill:a.chart._assignedColors[i].fill,stroke:a.chart._assignedColors[i].stroke,opacity:a.chart._assignedColors[i].opacity,css:a.chart._assignedClasses[i],series:a,aggField:t.aggField})})},this),r},this._getFontSize=function(){var t=this.fontSize&&"auto"!==this.fontSize.toString().toLowerCase()?isNaN(this.fontSize)?this.fontSize:this.fontSize+"px":(10<this.chart._heightPixels()/35?this.chart._heightPixels()/35:10)+"px";return t},this._getHorizontalPadding=function(){var t=isNaN(this.horizontalPadding)?20:this.horizontalPadding;return t},this._getVerticalPadding=function(){var t=isNaN(this.verticalPadding)?2:this.verticalPadding;return t},this._heightPixels=function(){return R._parseYPosition(this.height,this.chart.svg.node())},this._widthPixels=function(){return R._parseXPosition(this.width,this.chart.svg.node())},this._xPixels=function(){return R._parseXPosition(this.x,this.chart.svg.node())},this._yPixels=function(){return R._parseYPosition(this.y,this.chart.svg.node())}},R.series=function(t,e,i,s,a,r,n,o,l,h){this.chart=t,this.x=i,this.y=s,this.z=a,this.c=r,this.p=n,this.plot=o,this.categoryFields=e,this.aggregate=l,this.stacked=h,this.barGap=.2,this.clusterBarGap=.1,this.lineWeight=2,this.lineMarkers=!1,this.afterDraw=null,this.interpolation="linear",this.tooltipFontSize="10px",this.tooltipFontFamily="sans-serif",this.radius="auto",this._group=t._group.append("g"),this._group.attr("class","dimple-series-group-"+t.series.length),this._eventHandlers=[],this._positionData=[],this._orderRules=[],this._axisBounds=function(t){var s,a,r,e={min:0,max:0},i=null,n=null,o=[],l=0,h=this._positionData;return"x"===t?(i=this.x,n=this.y):"y"===t?(i=this.y,n=this.x):"z"===t?i=this.z:"p"===t?i=this.p:"c"===t&&(i=this.c),i.showPercent?h.forEach(function(t){t[i.position+"Bound"]<e.min&&(e.min=t[i.position+"Bound"]),t[i.position+"Bound"]>e.max&&(e.max=t[i.position+"Bound"])},this):null===n||null===n.categoryFields||0===n.categoryFields.length?h.forEach(function(t){!this._isStacked()||"x"!==i.position&&"y"!==i.position?(t[i.position+"Value"]<e.min&&(e.min=t[i.position+"Value"]),t[i.position+"Value"]>e.max&&(e.max=t[i.position+"Value"])):t[i.position+"Value"]<0?e.min=e.min+t[i.position+"Value"]:e.max=e.max+t[i.position+"Value"]},this):(s=i.position+"Value",a=n.position+"Field",r=[],h.forEach(function(t){var e=t[a].join("/"),i=r.indexOf(e);-1===i&&(r.push(e),i=r.length-1),void 0===o[i]&&(o[i]={min:0,max:0},l<=i)&&(l=i+1),this.stacked?t[s]<0?o[i].min=o[i].min+t[s]:o[i].max=o[i].max+t[s]:(t[s]<o[i].min&&(o[i].min=t[s]),t[s]>o[i].max&&(o[i].max=t[s]))},this),o.forEach(function(t){void 0!==t&&(t.min<e.min&&(e.min=t.min),t.max>e.max)&&(e.max=t.max)},this)),e},this._deepMatch=function(t){var e=!1;return this[t.position]===t?e=!0:void 0!==t._slaves&&null!==t._slaves&&0<t._slaves.length&&t._slaves.forEach(function(t){e=e||this._deepMatch(t)},this),e},this._dropLineOrigin=function(){var e=0,i=0,s={x:null,y:null},a={x:null,y:null};return this.chart.axes.forEach(function(t){"x"===t.position&&null===a.x?t._hasTimeField()?a.x=this.chart._xPixels():a.x=t._origin:"y"===t.position&&null===a.y&&(t._hasTimeField()?a.y=this.chart._yPixels()+this.chart._heightPixels():a.y=t._origin)},this),this.chart.axes.forEach(function(t){"x"!==t.position||this.x.hidden?"y"!==t.position||this.y.hidden||(this._deepMatch(t)&&(0===i?s.x=a.x:1===i&&(s.x=this.chart._xPixels()+this.chart._widthPixels())),i+=1):(this._deepMatch(t)&&(0===e?s.y=a.y:1===e&&(s.y=this.chart._yPixels())),e+=1)},this),s},this._getTooltipFontSize=function(){var t=this.tooltipFontSize&&"auto"!==this.tooltipFontSize.toString().toLowerCase()?isNaN(this.tooltipFontSize)?this.tooltipFontSize:this.tooltipFontSize+"px":(10<this.chart._heightPixels()/35?this.chart._heightPixels()/35:10)+"px";return t},this._isStacked=function(){return this.stacked&&(this.x._hasCategories()||this.y._hasCategories())},this.addEventHandler=function(t,e){this._eventHandlers.push({event:t,handler:e})},this.addOrderRule=function(t,e){this._orderRules.push({ordering:t,desc:e})},this.getTooltipText=function(i){var s=[];return null!==this.categoryFields&&void 0!==this.categoryFields&&0<this.categoryFields.length&&this.categoryFields.forEach(function(t,e){null!=t&&null!==i.aggField[e]&&void 0!==i.aggField[e]&&s.push(t+(i.aggField[e]!==t?": "+i.aggField[e]:""))},this),this.p?(this.x&&this.x._hasCategories()&&this.x._getTooltipText(s,i),this.y&&this.y._hasCategories()&&this.y._getTooltipText(s,i),this.z&&this.z._hasCategories()&&this.z._getTooltipText(s,i),this.p._getTooltipText(s,i)):(this.x&&this.x._getTooltipText(s,i),this.y&&this.y._getTooltipText(s,i),this.z&&this.z._getTooltipText(s,i)),this.c&&this.c._getTooltipText(s,i),s.filter(function(t,e){return s.indexOf(t)===e})}},R.storyboard=function(s,t){null!=t&&(t=[].concat(t)),this.chart=s,this.categoryFields=t,this.autoplay=!0,this.frameDuration=3e3,this.storyLabel=null,this.onTick=null,this.fontSize="10px",this.fontFamily="sans-serif",this._frame=0,this._animationTimer=null,this._categories=[],this._cachedCategoryFields=[],this._orderRules=[],this._drawText=function(){var e=this,i=0;e.storyLabel||(e.chart.axes.forEach(function(t){"x"===t.position&&(i+=1)},e),e.storyLabel=e.chart._group.append("text").attr("class","dimple-storyboard-label").attr("opacity",1).attr("x",e.chart._xPixels()+.01*e.chart._widthPixels()).attr("y",e.chart._yPixels()+(10<e.chart._heightPixels()/35?e.chart._heightPixels()/35:10)*(1<i?1.25:-1)).call(function(t){s.noFormats||t.style("font-family",e.fontFamily).style("font-size",e._getFontSize())})),e.storyLabel.text(e.categoryFields.join("\\")+": "+e.getFrameValue())},this._getCategories=function(){return this._categoryFields!==this._cachedCategoryFields&&(this._categories=[],this.chart._getAllData().forEach(function(i){var s="";null!==this.categoryFields&&(this.categoryFields.forEach(function(t,e){0<e&&(s+="/"),s+=i[t]},this),-1===this._categories.indexOf(s))&&(this._categories.push(s),this._categories.length)},this),this._cachedCategoryFields=this._categoryFields),this._categories},this._getFontSize=function(){var t=this.fontSize&&"auto"!==this.fontSize.toString().toLowerCase()?isNaN(this.fontSize)?this.fontSize:this.fontSize+"px":(10<this.chart._heightPixels()/35?this.chart._heightPixels()/35:10)+"px";return t},this._goToFrameIndex=function(t){this._frame=t%this._getCategories().length,this.chart.draw(this.frameDuration/2)},this.addOrderRule=function(t,e){this._orderRules.push({ordering:t,desc:e})},this.getFrameValue=function(){var t=null;return t=0<=this._frame&&this._getCategories().length>this._frame?this._getCategories()[this._frame]:t},this.goToFrame=function(t){0<this._getCategories().length&&(t=this._getCategories().indexOf(t),this._goToFrameIndex(t))},this.pauseAnimation=function(){null!==this._animationTimer&&(window.clearInterval(this._animationTimer),this._animationTimer=null)},this.startAnimation=function(){var t;null===this._animationTimer&&(null!==this.onTick&&this.onTick(this.getFrameValue()),this._animationTimer=window.setInterval(function(){t._goToFrameIndex(t._frame+1),null!==t.onTick&&t.onTick(t.getFrameValue()),t._drawText(t.frameDuration/2)},(t=this).frameDuration))},this.stopAnimation=function(){null!==this._animationTimer&&(window.clearInterval(this._animationTimer),this._animationTimer=null,this._frame=0)}},R.aggregateMethod.avg=function(t,e){return t.value=null===t.value||void 0===t.value?0:parseFloat(t.value),t.count=null===t.count||void 0===t.count?1:parseFloat(t.count),e.value=null===e.value||void 0===e.value?0:parseFloat(e.value),e.count=null===e.count||void 0===e.count?1:parseFloat(e.count),(t.value*t.count+e.value*e.count)/(t.count+e.count)},R.aggregateMethod.count=function(t,e){return t.count=null===t.count||void 0===t.count?0:parseFloat(t.count),e.count=null===e.count||void 0===e.count?0:parseFloat(e.count),t.count+e.count},R.aggregateMethod.max=function(t,e){return t.value=null===t.value||void 0===t.value?0:parseFloat(t.value),e.value=null===e.value||void 0===e.value?0:parseFloat(e.value),(t.value>e.value?t:e).value},R.aggregateMethod.min=function(t,e){return null!==t.value&&parseFloat(t.value)<parseFloat(e.value)?parseFloat(t.value):parseFloat(e.value)},R.aggregateMethod.sum=function(t,e){return t.value=null===t.value||void 0===t.value?0:parseFloat(t.value),e.value=null===e.value||void 0===e.value?0:parseFloat(e.value),t.value+e.value},R.plot.area={stacked:!0,grouped:!0,supportedAxes:["x","y","c"],draw:function(s,r,i){function e(t,e){var a;R._drawMarkers(t,s,r,i,M,L,function(t,e,i,s){j.select(e).style("opacity",1),R._showPointTooltip(t,e,i,s)},(a=t,function(t,e,i,s){j.select(e).style("opacity",s.lineMarkers||a.data.length<2?R._helpers.opacity(t,i,s):0),R._removeTooltip(t,e,i,s)}),e)}function t(t,e){var i;return"step"===r.interpolation&&r[t]._hasCategories()?(i=R._helpers[t](e,s,r)+("y"===t?R._helpers.height(e,s,r):0),r[t].categoryFields.length<2&&(i+=("y"===t?1:-1)*R._helpers[t+"Gap"](s,r))):i=R._helpers["c"+t](e,s,r),parseFloat(i)}function a(t,e){var i=j.line().x(function(t){return r.x._hasCategories()||!e?t.x:r.x[e]}).y(function(t){return r.y._hasCategories()||!e?t.y:r.y[e]});return R._interpolate(i,t),i}function D(t,e){return parseFloat(t)-parseFloat(e)}function G(t,e){return parseFloat(t.x)-parseFloat(e.x)}var n,o,l,h,c,u,d,p,g,_,f,x,y,m,v,F,k,w,C,b,P=r._positionData,B=[],S=null,M="dimple-series-"+s.series.indexOf(r),E=r.x._hasCategories()||r.y._hasCategories()?0:1,L=!1,T={},z=[],O=[],V="step"===r.interpolation?"step-after":r.interpolation,A=R._getSeriesOrder(r.data||s.data,r);for(r.c&&(r.x._hasCategories()&&r.y._hasMeasure()||r.y._hasCategories()&&r.x._hasMeasure())&&(L=!0),r.x._hasCategories()?(C="x",b="y"):r.y._hasCategories()&&(C="y",b="x"),n=0;n<P.length;n+=1){for(h=[],u=-1,l=E;l<P[n].aggField.length;l+=1)h.push(P[n].aggField[l]);for(c=R._createClass(h),l=0;l<B.length;l+=1)if(B[l].keyString===c){u=l;break}-1===u&&(u=B.length,B.push({key:h,keyString:c,color:"white",data:[],points:[],area:{},entry:{},exit:{},group:C&&P[n][C+"Field"]&&2<=P[n][C+"Field"].length?P[n][C+"Field"][0]:"All"})),B[u].data.push(P[n])}for(A&&B.sort(function(t,e){return R._arrayIndexCompare(A,t.key,e.key)}),n=0;n<B.length;n+=1){for(B[n].data.sort(R._getSeriesSortPredicate(s,r,A)),o=0;o<B[n].data.length;o+=1)B[n].points.push({x:t("x",B[n].data[o]),y:t("y",B[n].data[o])}),C&&(T[B[n].group]||(T[B[n].group]={}),T[B[n].group][B[n].points[B[n].points.length-1][C]]=r[b]._origin);p=B[n].points,"step"===r.interpolation&&1<p.length&&C&&(r.x._hasCategories()?(p.push({x:2*p[p.length-1].x-p[p.length-2].x,y:p[p.length-1].y}),T[B[n].group][p[p.length-1][C]]=r[b]._origin):r.y._hasCategories()&&(p=[{x:p[0].x,y:2*p[0].y-p[1].y}].concat(p),T[B[n].group][p[0][C]]=r[b]._origin,B[n].points=p))}for(f in T)if(T.hasOwnProperty(f)){for(x in z[f]=[],T[f])T[f].hasOwnProperty(x)&&z[f].push(parseFloat(x));z[f].sort(D)}for(n=0;n<B.length;n+=1){if(p=B[n].points,y=B[n].group,g=[],O=[],L&&R._addGradient(B[n].key,"fill-area-gradient-"+B[n].keyString,r.x._hasCategories()?r.x:r.y,P,s,i,"fill"),z[y]&&0<z[y].length)for(l=o=0;o<z[y].length;o+=1)z[y][o]>=p[0][C]&&z[y][o]<=p[p.length-1][C]&&((_={})[C]=z[y][o],_[b]=T[y][z[y][o]],g.push(_),p[l][C]>z[y][o]?O.push(_):(O.push(p[l]),T[B[n].group][z[y][o]]=p[l][b],l+=1));else if(r._orderRules&&0<r._orderRules.length)O=p.concat(p[0]);else for(p=p.sort(G),O.push(p[0]),w=0;w=function(t,e,i){for(var s,a=e[e.length-1],r=9999,n=a,o=0;o<t.length;o+=1)t[o].x===a.x&&t[o].y===a.y||i<(s=180-Math.atan2(t[o].x-a.x,t[o].y-a.y)*(180/Math.PI))&&s<r&&(n=t[o],r=s);return e.push(n),r}(p,O,w),O.length<=p.length&&(O[0].x!==O[O.length-1].x||O[0].y!==O[O.length-1].y););g=g.reverse(),m=a(V,"_previousOrigin")(O),v=a("step-after"===V?"step-before":"step-before"===V?"step-after":V,"_previousOrigin")(g),k=-1===(F=a("linear","_previousOrigin")(O)).indexOf("L")?void 0:F.indexOf("L"),B[n].entry=m+(v&&0<v.length?"L"+v.substring(1):"")+(F&&0<F.length?"L"+F.substring(1,k):0),m=a(V)(O),v=a("step-after"===V?"step-before":"step-before"===V?"step-after":V)(g),k=-1===(F=a("linear")(O)).indexOf("L")?void 0:F.indexOf("L"),B[n].update=m+(v&&0<v.length?"L"+v.substring(1):"")+(F&&0<F.length?"L"+F.substring(1,k):0),m=a(V,"_origin")(O),v=a("step-after"===V?"step-before":"step-before"===V?"step-after":V,"_origin")(g),k=-1===(F=a("linear","_origin")(O)).indexOf("L")?void 0:F.indexOf("L"),B[n].exit=m+(v&&0<v.length?"L"+v.substring(1):"")+(F&&0<F.length?"L"+F.substring(1,k):0),B[n].color=s.getColor(0<B[n].key.length?B[n].key[B[n].key.length-1]:"All"),B[n].css=s.getClass(0<B[n].key.length?B[n].key[B[n].key.length-1]:"All")}s._tooltipGroup&&s._tooltipGroup.remove(),d=(S=r.shapes?r.shapes.data(B,function(t){return t.key}):r._group.selectAll("."+M).data(B,function(t){return t.key})).enter().append("path").attr("id",function(t){return R._createClass([t.key])}).attr("class",function(t){return M+" dimple-line "+t.keyString+" "+s.customClassList.areaSeries+" "+t.css}).attr("d",function(t){return t.entry}).call(function(t){s.noFormats||t.attr("opacity",function(t){return L?1:t.color.opacity}).style("fill",function(t){return L?"url(#"+R._createClass(["fill-area-gradient-"+t.keyString])+")":t.color.fill}).style("stroke",function(t){return L?"url(#"+R._createClass(["stroke-area-gradient-"+t.keyString])+")":t.color.stroke}).style("stroke-width",r.lineWeight)}).each(function(t){t.markerData=t.data,e(t,this)}),d=s._handleTransition(S.merge(d),i,s).attr("d",function(t){return t.update}).each(function(t){t.markerData=t.data,e(t,this)}),S=s._handleTransition(S.exit(),i,s).attr("d",function(t){return t.exit}).each(function(t){t.markerData=[],e(t,this)}),R._postDrawHandling(r,d,S,i),r.shapes=r._group.selectAll("."+M)}},R.plot.bar={stacked:!0,grouped:!1,supportedAxes:["x","y","c"],draw:function(i,s,t){var e=s._positionData,a=null,r=["dimple-series-"+i.series.indexOf(s),"dimple-bar"],n=!s._isStacked()&&s.x._hasMeasure(),o=!s._isStacked()&&s.y._hasMeasure(),l="none";s.x._hasCategories()&&s.y._hasCategories()?l="both":s.x._hasCategories()?l="x":s.y._hasCategories()&&(l="y"),i._tooltipGroup&&i._tooltipGroup.remove(),e=(a=s.shapes?s.shapes.data(e,function(t){return t.key}):s._group.selectAll("."+r.join(".")).data(e,function(t){return t.key})).enter().append("rect").attr("id",function(t){return R._createClass([t.key])}).attr("class",function(t){var e=[];return e=(e=(e=e.concat(t.aggField)).concat(t.xField)).concat(t.yField),r.join(" ")+" "+R._createClass(e)+" "+i.customClassList.barSeries+" "+R._helpers.css(t,i)}).attr("x",function(t){var e=s.x._previousOrigin;return"x"===l?e=R._helpers.x(t,i,s):"both"===l&&(e=R._helpers.cx(t,i,s)),e}).attr("y",function(t){var e=s.y._previousOrigin;return"y"===l?e=R._helpers.y(t,i,s):"both"===l&&(e=R._helpers.cy(t,i,s)),e}).attr("width",function(t){return"x"===l?R._helpers.width(t,i,s):0}).attr("height",function(t){return"y"===l?R._helpers.height(t,i,s):0}).on("mouseover",function(t,e){R._showBarTooltip(e,this,i,s)}).on("mouseleave",function(t,e){R._removeTooltip(e,this,i,s)}).call(function(t){i.noFormats||t.attr("opacity",function(t){return R._helpers.opacity(t,i,s)}).style("fill",function(t){return R._helpers.fill(t,i,s)}).style("stroke",function(t){return R._helpers.stroke(t,i,s)})}),e=i._handleTransition(a.merge(e),t,i,s).attr("x",function(t){return n?R._helpers.cx(t,i,s)-s.x.floatingBarWidth/2:R._helpers.x(t,i,s)}).attr("y",function(t){return o?R._helpers.cy(t,i,s)-s.y.floatingBarWidth/2:R._helpers.y(t,i,s)}).attr("width",function(t){return n?s.x.floatingBarWidth:R._helpers.width(t,i,s)}).attr("height",function(t){return o?s.y.floatingBarWidth:R._helpers.height(t,i,s)}).call(function(t){i.noFormats||t.attr("fill",function(t){return R._helpers.fill(t,i,s)}).attr("stroke",function(t){return R._helpers.stroke(t,i,s)})}),a=i._handleTransition(a.exit(),t,i,s).attr("x",function(t){var e=s.x._origin;return"x"===l?e=R._helpers.x(t,i,s):"both"===l&&(e=R._helpers.cx(t,i,s)),e}).attr("y",function(t){var e=s.y._origin;return"y"===l?e=R._helpers.y(t,i,s):"both"===l&&(e=R._helpers.cy(t,i,s)),e}).attr("width",function(t){return"x"===l?R._helpers.width(t,i,s):0}).attr("height",function(t){return"y"===l?R._helpers.height(t,i,s):0}),R._postDrawHandling(s,e,a,t),s.shapes=s._group.selectAll("."+r.join("."))}},R.plot.bubble={stacked:!1,grouped:!1,supportedAxes:["x","y","z","c"],draw:function(i,s,t){var e=s._positionData,a=null,r=["dimple-series-"+i.series.indexOf(s),"dimple-bubble"];i._tooltipGroup&&i._tooltipGroup.remove(),e=(a=s.shapes?s.shapes.data(e,function(t){return t.key}):s._group.selectAll("."+r.join(".")).data(e,function(t){return t.key})).enter().append("circle").attr("id",function(t){return R._createClass([t.key])}).attr("class",function(t){var e=[];return e=(e=(e=(e=e.concat(t.aggField)).concat(t.xField)).concat(t.yField)).concat(t.zField),r.join(" ")+" "+R._createClass(e)+" "+i.customClassList.bubbleSeries+" "+R._helpers.css(t,i)}).attr("cx",function(t){return s.x._hasCategories()?R._helpers.cx(t,i,s):s.x._previousOrigin}).attr("cy",function(t){return s.y._hasCategories()?R._helpers.cy(t,i,s):s.y._previousOrigin}).attr("r",0).on("mouseover",function(t,e){R._showPointTooltip(e,this,i,s)}).on("mouseleave",function(t,e){R._removeTooltip(e,this,i,s)}).call(function(t){i.noFormats||t.attr("opacity",function(t){return R._helpers.opacity(t,i,s)}).style("fill",function(t){return R._helpers.fill(t,i,s)}).style("stroke",function(t){return R._helpers.stroke(t,i,s)})}),e=i._handleTransition(a.merge(e),t,i,s).attr("cx",function(t){return R._helpers.cx(t,i,s)}).attr("cy",function(t){return R._helpers.cy(t,i,s)}).attr("r",function(t){return R._helpers.r(t,i,s)}).call(function(t){i.noFormats||t.attr("fill",function(t){return R._helpers.fill(t,i,s)}).attr("stroke",function(t){return R._helpers.stroke(t,i,s)})}),a=i._handleTransition(a.exit(),t,i,s).attr("r",0).attr("cx",function(t){return s.x._hasCategories()?R._helpers.cx(t,i,s):s.x._origin}).attr("cy",function(t){return s.y._hasCategories()?R._helpers.cy(t,i,s):s.y._origin}),R._postDrawHandling(s,e,a,t),s.shapes=s._group.selectAll("."+r.join("."))}},R.plot.line={stacked:!1,grouped:!0,supportedAxes:["x","y","c"],draw:function(i,s,r){function e(t,e){var a;R._drawMarkers(t,i,s,r,f,y,function(t,e,i,s){j.select(e).style("opacity",1),R._showPointTooltip(t,e,i,s)},(a=t,function(t,e,i,s){j.select(e).style("opacity",s.lineMarkers||a.data.length<2?R._helpers.opacity(t,i,s):0),R._removeTooltip(t,e,i,s)}),e)}function t(t,e){return t="step"===s.interpolation&&s[t]._hasCategories()?(s.barGap=0,s.clusterBarGap=0,R._helpers[t](e,i,s)+("y"===t?R._helpers.height(e,i,s):0)):R._helpers["c"+t](e,i,s),parseFloat(t.toFixed(1))}function a(t,e){var i=j.line().x(function(t){return s.x._hasCategories()||!e?t.x:s.x[e]}).y(function(t){return s.y._hasCategories()||!e?t.y:s.y[e]});return R._interpolate(i,t),i}var n,o,l,h,c,u,d,p=s._positionData,g=[],_=null,f="dimple-series-"+i.series.indexOf(s),x=s.x._hasCategories()||s.y._hasCategories()?0:1,y=!1,m="step"===s.interpolation?"step-after":s.interpolation,v=R._getSeriesOrder(s.data||i.data,s);for(s.c&&(s.x._hasCategories()&&s.y._hasMeasure()||s.y._hasCategories()&&s.x._hasMeasure())&&(y=!0),n=0;n<p.length;n+=1){for(h=[],u=-1,l=x;l<p[n].aggField.length;l+=1)h.push(p[n].aggField[l]);for(c=R._createClass(h),l=0;l<g.length;l+=1)if(g[l].keyString===c){u=l;break}-1===u&&(u=g.length,g.push({key:h,keyString:c,color:"white",data:[],markerData:[],points:[],line:{},entry:{},exit:{}})),g[u].data.push(p[n])}for(v&&g.sort(function(t,e){return R._arrayIndexCompare(v,t.key,e.key)}),n=0;n<g.length;n+=1){for(g[n].data.sort(R._getSeriesSortPredicate(i,s,v)),y&&R._addGradient(g[n].key,"fill-line-gradient-"+g[n].keyString,s.x._hasCategories()?s.x:s.y,p,i,r,"fill"),o=0;o<g[n].data.length;o+=1)g[n].points.push({x:t("x",g[n].data[o]),y:t("y",g[n].data[o])});"step"===s.interpolation&&1<g[n].points.length&&(s.x._hasCategories()?g[n].points.push({x:2*g[n].points[g[n].points.length-1].x-g[n].points[g[n].points.length-2].x,y:g[n].points[g[n].points.length-1].y}):s.y._hasCategories()&&(g[n].points=[{x:g[n].points[0].x,y:2*g[n].points[0].y-g[n].points[1].y}].concat(g[n].points))),g&&g[n]&&g[n].points&&1===g[n].points.length&&g[n].points.push({x:g[n].points[0].x,y:g[n].points[0].y}),g[n].entry=a(m,"_previousOrigin")(g[n].points),g[n].update=a(m)(g[n].points),g[n].exit=a(m,"_origin")(g[n].points),g[n].color=i.getColor(0<g[n].key.length?g[n].key[g[n].key.length-1]:"All"),g[n].css=i.getClass(0<g[n].key.length?g[n].key[g[n].key.length-1]:"All")}i._tooltipGroup&&i._tooltipGroup.remove(),d=(_=s.shapes?s.shapes.data(g,function(t){return t.key}):s._group.selectAll("."+f).data(g,function(t){return t.key})).enter().append("path").attr("id",function(t){return R._createClass([t.key])}).attr("class",function(t){return f+" dimple-line "+t.keyString+" "+i.customClassList.lineSeries+" "+t.css}).attr("d",function(t){return t.entry}).call(function(t){i.noFormats||t.attr("opacity",function(t){return y?1:t.color.opacity}).style("fill","none").style("stroke",function(t){return y?"url(#"+R._createClass(["fill-line-gradient-"+t.keyString])+")":t.color.stroke}).style("stroke-width",s.lineWeight)}).each(function(t){t.markerData=t.data,e(t,this)}),d=i._handleTransition(_.merge(d),r,i).attr("d",function(t){return t.update}).each(function(t){t.markerData=t.data,e(t,this)}),_=i._handleTransition(_.exit(),r,i).attr("d",function(t){return t.exit}).each(function(t){t.markerData=[],e(t,this)}),R._postDrawHandling(s,d,_,r),s.shapes=s._group.selectAll("."+f)}},R.plot.pie={stacked:!1,grouped:!1,supportedAxes:["x","y","c","z","p"],draw:function(s,a,e){function r(t){return t=u(t),a.outerRadius&&(t=R._parsePosition(a.outerRadius,t)),Math.max(t,0)}function n(t){var e=0;return a.innerRadius&&(e=R._parsePosition(a.innerRadius,u(t))),Math.max(e,0)}function i(t){return j.arc().innerRadius(n(t)).outerRadius(r(t))(t)}function o(t){t.innerRadius=n(t),t.outerRadius=r(t);var e=j.interpolate(this._current,t),i=j.arc().innerRadius(function(t){return t.innerRadius}).outerRadius(function(t){return t.outerRadius});return this._current=e(0),function(t){return i(e(t))}}function t(i){return function(t){var e,t=a.x&&a.y?(e=!i||a.x._hasCategories()?R._helpers.cx(t,s,a):a.x._previousOrigin,!i||a.y._hasCategories()?R._helpers.cy(t,s,a):a.y._previousOrigin):(e=s._xPixels()+s._widthPixels()/2,s._yPixels()+s._heightPixels()/2);return"translate("+e+","+t+")"}}var l=a._positionData,h=null,c=["dimple-series-"+s.series.indexOf(a),"dimple-pie"],u=function(t){t=a.x&&a.y?R._helpers.r(t,s,a):s._widthPixels()<s._heightPixels()?s._widthPixels()/2:s._heightPixels()/2;return t};s._tooltipGroup&&s._tooltipGroup.remove(),l=(h=a.shapes?a.shapes.data(l,function(t){return t.key}):a._group.selectAll("."+c.join(".")).data(l,function(t){return t.key})).enter().append("path").attr("id",function(t){return R._createClass([t.key])}).attr("class",function(t){var e=[];return e=(e=e.concat(t.aggField)).concat(t.pField),c.join(" ")+" "+R._createClass(e)+" "+s.customClassList.pieSeries+" "+R._helpers.css(t,s)}).attr("d",i).on("mouseover",function(t,e){R._showBarTooltip(e,this,s,a)}).on("mouseleave",function(t,e){R._removeTooltip(e,this,s,a)}).call(function(t){s.noFormats||t.attr("opacity",function(t){return R._helpers.opacity(t,s,a)}).style("fill",function(t){return R._helpers.fill(t,s,a)}).style("stroke",function(t){return R._helpers.stroke(t,s,a)})}).attr("transform",t(!0)).each(function(t){(this._current=t).innerRadius=n(t),t.outerRadius=r(t)}),l=s._handleTransition(h.merge(l),e,s,a).call(function(t){e&&0<e?t.attrTween("d",o):t.attr("d",i),s.noFormats||t.attr("fill",function(t){return R._helpers.fill(t,s,a)}).attr("stroke",function(t){return R._helpers.stroke(t,s,a)})}).attr("transform",t(!1)),h=s._handleTransition(h.exit(),e,s,a).attr("transform",t(!0)).attr("d",i),R._postDrawHandling(a,l,h,e),a.shapes=a._group.selectAll("."+c.join("."))}},R._addGradient=function(t,e,i,a,s,r,n){var o=[].concat(t),t=s.svg.select("#"+R._createClass([e])),l=[],h=i.position+"Field",c=!0,u=[];a.forEach(function(t){-1===l.indexOf(t[h])&&t.aggField.join("_")===o.join("_")&&l.push(t[h])},this),l=l.sort(function(t,e){return i._scale(t)-i._scale(e)}),null===t.node()&&(c=!1,t=s.svg.append("defs").append("linearGradient").attr("id",R._createClass([e])).attr("gradientUnits","userSpaceOnUse").attr("x1","x"===i.position?i._scale(l[0])+s._widthPixels()/l.length/2:0).attr("y1","y"===i.position?i._scale(l[0])-s._heightPixels()/l.length/2:0).attr("x2","x"===i.position?i._scale(l[l.length-1])+s._widthPixels()/l.length/2:0).attr("y2","y"===i.position?i._scale(l[l.length-1])-s._heightPixels()/l.length/2:0)),l.forEach(function(t,e){for(var i={},s=0,s=0;s<a.length;s+=1)if(a[s].aggField.join("_")===o.join("_")&&a[s][h].join("_")===t.join("_")){i=a[s];break}u.push({offset:Math.round(e/(l.length-1)*100)+"%",color:i[n]})},this),c?s._handleTransition(t.selectAll("stop").data(u),r,s).attr("offset",function(t){return t.offset}).attr("stop-color",function(t){return t.color}):t.selectAll("stop").data(u).enter().append("stop").attr("offset",function(t){return t.offset}).attr("stop-color",function(t){return t.color})},R._arrayIndexCompare=function(t,e,i){for(var s,a,r,n,o,l=0;l<t.length;l+=1){for(n=r=!0,o=[].concat(t[l]),a=0;a<e.length;a+=1)r=r&&e[a]===o[a];for(a=0;a<i.length;a+=1)n=n&&i[a]===o[a];if(r||n){s=r&&n?0:r?-1:1;break}}return s},R._createClass=function(t){var e,i=[],s=function(t){var e=t.charCodeAt(0),i="-";return i=65<=e&&e<=90?t.toLowerCase():i};if(0<t.length)for(e=0;e<t.length;e+=1)t[e]&&i.push("dimple-"+t[e].toString().replace(/[^a-z0-9]/g,s));else i=["dimple-all"];return i.join(" ")},R._drawMarkerBacks=function(t,e,i,s,a,r){var n=["dimple-marker-back",a,t.keyString];i.lineMarkers&&(a=null===i._markerBacks||void 0===i._markerBacks||void 0===i._markerBacks[t.keyString]?i._group.selectAll("."+n.join(".")).data(t.markerData):i._markerBacks[t.keyString].data(t.markerData,function(t){return t.key}),(r=r.nextSibling&&r.nextSibling.id?a.enter().insert("circle","#"+r.nextSibling.id):a.enter().append("circle")).attr("id",function(t){return R._createClass([t.key+" Marker Back"])}).attr("class",function(t){var e=[];return i.x._hasCategories()&&(e=e.concat(t.xField)),i.y._hasCategories()&&(e=e.concat(t.yField)),R._createClass(e)+" "+n.join(" ")}).attr("cx",function(t){return i.x._hasCategories()?R._helpers.cx(t,e,i):i.x._previousOrigin}).attr("cy",function(t){return i.y._hasCategories()?R._helpers.cy(t,e,i):i.y._previousOrigin}).attr("r",0).attr("fill","white").attr("stroke","none"),e._handleTransition(a.merge(r),s,e).attr("cx",function(t){return R._helpers.cx(t,e,i)}).attr("cy",function(t){return R._helpers.cy(t,e,i)}).attr("r",2+i.lineWeight),r=e._handleTransition(a.exit(),s,e).attr("cx",function(t){return i.x._hasCategories()?R._helpers.cx(t,e,i):i.x._origin}).attr("cy",function(t){return i.y._hasCategories()?R._helpers.cy(t,e,i):i.y._origin}).attr("r",0),0===s?r.remove():r.each("end",function(){j.select(this).remove()}),void 0!==i._markerBacks&&null!==i._markerBacks||(i._markerBacks={}),i._markerBacks[t.keyString]=a)},R._drawMarkers=function(e,s,a,t,i,r,n,o,l){var h=["dimple-marker",i,e.keyString],c=null===a._markers||void 0===a._markers||void 0===a._markers[e.keyString]?a._group.selectAll("."+h.join(".")).data(e.markerData):a._markers[e.keyString].data(e.markerData,function(t){return t.key}),u=l.nextSibling&&l.nextSibling.id?c.enter().insert("circle","#"+l.nextSibling.id):c.enter().append("circle");u.attr("id",function(t){return R._createClass([t.key+" Marker"])}).attr("class",function(t){var e=[],i=s.getClass(0<t.aggField.length?t.aggField[t.aggField.length-1]:"All");return a.x._hasCategories()&&(e=e.concat(t.xField)),a.y._hasCategories()&&(e=e.concat(t.yField)),R._createClass(e)+" "+h.join(" ")+" "+s.customClassList.lineMarker+" "+i}).on("mouseover",function(t,e){n(e,this,s,a)}).on("mouseleave",function(t,e){o(e,this,s,a)}).attr("cx",function(t){return a.x._hasCategories()?R._helpers.cx(t,s,a):a.x._previousOrigin}).attr("cy",function(t){return a.y._hasCategories()?R._helpers.cy(t,s,a):a.y._previousOrigin}).attr("r",0).attr("opacity",a.lineMarkers||e.data.length<2?e.color.opacity:0).call(function(t){s.noFormats||t.attr("fill","white").style("stroke-width",a.lineWeight).attr("stroke",function(t){return r?R._helpers.fill(t,s,a):e.color.stroke})}),s._handleTransition(c.merge(u),t,s).attr("cx",function(t){return R._helpers.cx(t,s,a)}).attr("cy",function(t){return R._helpers.cy(t,s,a)}).attr("r",2+a.lineWeight).attr("opacity",a.lineMarkers||e.data.length<2?e.color.opacity:0).call(function(t){s.noFormats||t.attr("fill","white").style("stroke-width",a.lineWeight).attr("stroke",function(t){return r?R._helpers.fill(t,s,a):e.color.stroke})}),u=s._handleTransition(c.exit(),t,s).attr("cx",function(t){return a.x._hasCategories()?R._helpers.cx(t,s,a):a.x._origin}).attr("cy",function(t){return a.y._hasCategories()?R._helpers.cy(t,s,a):a.y._origin}).attr("r",0),0===t?u.remove():u.each("end",function(){j.select(this).remove()}),void 0!==a._markers&&null!==a._markers||(a._markers={}),a._markers[e.keyString]=c,R._drawMarkerBacks(e,s,a,t,i,l)},R._ease=function(t,e){if(t&&e&&"[object String]"===Object.prototype.toString.call(e)){switch(e){case"linear":e=j.easeLinear;break;case"poly":e=j.easePoly;break;case"quad":e=j.easeQuad;break;case"cubic":e=j.easeCubic;break;case"sin":e=j.easeSin;break;case"exp":e=j.easeExp;break;case"circle":e=j.easeCircle;break;case"elastic":e=j.easeElastic;break;case"back":e=j.easeBack;break;case"bounce":e=j.easeBounce}t.ease(e)}},R._getOrderedList=function(a,t,e){var r=[],s=[],c=[].concat(t),n=[].concat(t),t=[];return(t=(t=null!=e?t.concat(e):t).concat({ordering:c,desc:!1})).forEach(function(t){var e,i=[],s=[];if("function"==typeof t.ordering){if(a&&0<a.length)for(e in a[0])a[0].hasOwnProperty(e)&&-1===n.indexOf(e)&&n.push(e)}else if(t.ordering instanceof Array){for(e=0;e<t.ordering.length;e+=1)a&&0<a.length&&a[0].hasOwnProperty(t.ordering[e])&&s.push(t.ordering[e]),i.push(t.ordering[e]);i.length/2<s.length?n.concat(s):t.values=i}else n.push(t.ordering)},this),e=R._rollUp(a,c,n),1<=t.length&&(t.forEach(function(t){var o=null!==t.desc&&void 0!==t.desc&&t.desc,i=t.ordering,l=[],h=function(t){for(var e=0,i=0;i<t.length;i+=1){if(isNaN(t[i])){e=void 0;break}e+=parseFloat(t[i])}return e};"function"==typeof i?r.push(function(t,e){return(o?-1:1)*i(t,e)}):t.values&&0<t.values.length?(t.values.forEach(function(t){l.push([].concat(t).join("|"))},this),r.push(function(t,e){for(var i,s,a="",r="",n=0;n<c.length;n+=1)0<n&&(a+="|",r+="|"),a+=t[c[n]],r+=e[c[n]];return i=l.indexOf(a),s=l.indexOf(r),(o?-1:1)*((i<0?o?-1:l.length:i)-(s<0?o?-1:l.length:s))})):[].concat(t.ordering).forEach(function(n){r.push(function(t,e){var i,s,a,r=0;return void 0!==t[n]&&void 0!==e[n]&&(t=[].concat(t[n]),e=[].concat(e[n]),i=0,s=h(t),a=h(e),isNaN(s)||isNaN(a)?isNaN(Date.parse(t[0]))||isNaN(Date.parse(e[0]))?t[0]<e[0]?i=-1:t[0]>e[0]&&(i=1):i=Date.parse(t[0])-Date.parse(e[0]):i=parseFloat(s)-parseFloat(a),r=i),(o?-1:1)*r})})}),e.sort(function(t,e){for(var i=0,s=0;i<r.length&&0===s;)s=r[i](t,e),i+=1;return s}),e.forEach(function(t){var e,i=[];if(1===c.length)s.push(t[c[0]]);else{for(e=0;e<c.length;e+=1)i.push(t[c[e]]);s.push(i)}},this)),s},R._getSeriesOrder=function(t,e){var i=[].concat(e._orderRules),s=e.categoryFields,a=[];return null!=s&&0<s.length&&(null!==e.c&&void 0!==e.c&&e.c._hasMeasure()&&i.push({ordering:e.c.measure,desc:!0}),e.x._hasMeasure()&&i.push({ordering:e.x.measure,desc:!0}),e.y._hasMeasure()&&i.push({ordering:e.y.measure,desc:!0}),a=R._getOrderedList(t,s,i)),a},R._getSeriesSortPredicate=function(s,a,r){return function(t,e){var i=0;return i=0===(i=0===(i=a.x._hasCategories()?R._helpers.cx(t,s,a)-R._helpers.cx(e,s,a):i)&&a.y._hasCategories()?R._helpers.cy(t,s,a)-R._helpers.cy(e,s,a):i)&&r?R._arrayIndexCompare(r,t.aggField,e.aggField):i}},R._helpers={cx:function(t,e,i){return null!==i.x.measure&&void 0!==i.x.measure?i.x._scale(t.cx):i.x._hasCategories()&&2<=i.x.categoryFields.length?i.x._scale(t.cx)+R._helpers.xGap(e,i)+(t.xOffset+.5)*((e._widthPixels()/i.x._max-2*R._helpers.xGap(e,i))*t.width):i.x._scale(t.cx)+e._widthPixels()/i.x._max/2},cy:function(t,e,i){return null!==i.y.measure&&void 0!==i.y.measure?i.y._scale(t.cy):null!==i.y.categoryFields&&void 0!==i.y.categoryFields&&2<=i.y.categoryFields.length?i.y._scale(t.cy)-e._heightPixels()/i.y._max+R._helpers.yGap(e,i)+(t.yOffset+.5)*((e._heightPixels()/i.y._max-2*R._helpers.yGap(e,i))*t.height):i.y._scale(t.cy)-e._heightPixels()/i.y._max/2},r:function(t,e,i){var s=1;return null===i.z||void 0===i.z?i.radius&&"auto"!==i.radius?i.radius:5:(i.radius&&"auto"!==i.radius&&1<i.radius&&(s=i.radius/i.z._scale(i.z._max)),i.z._hasMeasure()?i.z._scale(t.r)*s:i.z._scale(e._heightPixels()/100)*s)},xGap:function(t,e){var i=0;return i=(null===e.x.measure||void 0===e.x.measure)&&0<e.barGap?t._widthPixels()/e.x._max*(.99<e.barGap?.99:e.barGap)/2:i},xClusterGap:function(t,e,i){var s=0;return s=null!==i.x.categoryFields&&void 0!==i.x.categoryFields&&2<=i.x.categoryFields.length&&0<i.clusterBarGap&&!i.x._hasMeasure()?t.width*(e._widthPixels()/i.x._max-2*R._helpers.xGap(e,i))*(.99<i.clusterBarGap?.99:i.clusterBarGap)/2:s},yGap:function(t,e){var i=0;return i=(null===e.y.measure||void 0===e.y.measure)&&0<e.barGap?t._heightPixels()/e.y._max*(.99<e.barGap?.99:e.barGap)/2:i},yClusterGap:function(t,e,i){var s=0;return s=null!==i.y.categoryFields&&void 0!==i.y.categoryFields&&2<=i.y.categoryFields.length&&0<i.clusterBarGap&&!i.y._hasMeasure()?t.height*(e._heightPixels()/i.y._max-2*R._helpers.yGap(e,i))*(.99<i.clusterBarGap?.99:i.clusterBarGap)/2:s},x:function(t,e,i){return i.x._hasTimeField()?i.x._scale(t.x)-R._helpers.width(t,e,i)/2:null!==i.x.measure&&void 0!==i.x.measure?i.x._scale(t.x):i.x._scale(t.x)+R._helpers.xGap(e,i)+t.xOffset*(R._helpers.width(t,e,i)+2*R._helpers.xClusterGap(t,e,i))+R._helpers.xClusterGap(t,e,i)},y:function(t,e,i){return i.y._hasTimeField()?i.y._scale(t.y)-R._helpers.height(t,e,i)/2:null!==i.y.measure&&void 0!==i.y.measure?i.y._scale(t.y):i.y._scale(t.y)-e._heightPixels()/i.y._max+R._helpers.yGap(e,i)+t.yOffset*(R._helpers.height(t,e,i)+2*R._helpers.yClusterGap(t,e,i))+R._helpers.yClusterGap(t,e,i)},width:function(t,e,i){return null!==i.x.measure&&void 0!==i.x.measure?Math.abs(i.x._scale(t.x<0?t.x-t.width:t.x+t.width)-i.x._scale(t.x)):i.x._hasTimeField()?i.x.floatingBarWidth:t.width*(e._widthPixels()/i.x._max-2*R._helpers.xGap(e,i))-2*R._helpers.xClusterGap(t,e,i)},height:function(t,e,i){return i.y._hasTimeField()?i.y.floatingBarWidth:null!==i.y.measure&&void 0!==i.y.measure?Math.abs(i.y._scale(t.y)-i.y._scale(t.y<=0?t.y+t.height:t.y-t.height)):t.height*(e._heightPixels()/i.y._max-2*R._helpers.yGap(e,i))-2*R._helpers.yClusterGap(t,e,i)},opacity:function(t,e,i){return(null!==i.c&&void 0!==i.c?t:e.getColor(t.aggField.slice(-1)[0])).opacity},fill:function(t,e,i){return(null!==i.c&&void 0!==i.c?t:e.getColor(t.aggField.slice(-1)[0])).fill},stroke:function(t,e,i){return(null!==i.c&&void 0!==i.c?t:e.getColor(t.aggField.slice(-1)[0])).stroke},css:function(t,e){return e.getClass(t.aggField.slice(-1)[0])}},R._interpolate=function(t,e){if(t&&e){if("[object String]"===Object.prototype.toString.call(e))switch(e){case"linear":e=j.curveLinear;break;case"linear-closed":e=j.curveLinearClosed;break;case"step":e=j.curveStep;break;case"step-before":e=j.curveStepBefore;break;case"step-after":e=j.curveStepAfter;break;case"basis":e=j.curveBasis;break;case"basis-open":e=j.curveBasisOpen;break;case"basis-closed":e=j.curveBasisClosed;break;case"bundle":e=j.curveBundle;break;case"cardinal":e=j.curveCardinal;break;case"cardinal-open":e=j.curveCardinalOpen;break;case"cardinal-closed":e=j.curveCardinalClosed;break;case"monotone":e=j.curveMonotoneX}t.curve(e)}},R._parentHeight=function(t){var e=t.getBoundingClientRect().height;return e=!e||e<0?t.clientHeight:e},R._parentWidth=function(t){var e=t.getBoundingClientRect().width;return e=!e||e<0?t.clientWidth:e},R._parsePosition=function(e,i){var s=0;return e&&e.toString().split(",").forEach(function(t){t&&(isNaN(t)?"%"===t.slice(-1)?s+=i*(parseFloat(t.slice(0,t.length-1))/100):"px"===t.slice(-2)?s+=parseFloat(t.slice(0,t.length-2)):s=e:s+=parseFloat(t))},this),s=s<0?i+s:s},R._parseXPosition=function(t,e){return R._parsePosition(t,R._parentWidth(e))},R._parseYPosition=function(t,e){return R._parsePosition(t,R._parentHeight(e))},R._postDrawHandling=function(i,t,e,s){0===s?(t.each(function(t,e){i.afterDraw&&i.afterDraw(this,t,e)}),e.remove()):(t.on("end",function(t,e){i.afterDraw&&i.afterDraw(this,t,e)}),e.call(function(){i.shapes&&i.shapes.exit().remove()}))},R._removeTooltip=function(t,e,i,s){i._tooltipGroup&&i._tooltipGroup.remove()},R._rollUp=function(t,r,n){var o=[];return r=null!=r?[].concat(r):[],t.forEach(function(i){var s=-1,e={},a=!0;o.forEach(function(e,t){-1===s&&(a=!0,r.forEach(function(t){a=a&&i[t]===e[t]},this),a)&&(s=t)},this),-1!==s?e=o[s]:(r.forEach(function(t){e[t]=i[t]},this),o.push(e),s=o.length-1),n.forEach(function(t){-1===r.indexOf(t)&&(void 0===e[t]&&(e[t]=[]),e[t]=e[t].concat(i[t]))},this),o[s]=e},this),o},R._showBarTooltip=function(t,e,a,i){function s(t,e){var i=o.node().getCTM(),s=a.svg.node().createSVGPoint();return s.x=t||0,s.y=e||0,s.matrixTransform(i)}var r,n,o=j.select(e),e=o.node().getBBox().x,l=o.node().getBBox().y,h=o.node().getBBox().width,c=o.node().getBBox().height,u=o.attr("opacity"),d=o.attr("fill"),p=i._dropLineOrigin(),g=j.rgb(j.rgb(d).r+.6*(255-j.rgb(d).r),j.rgb(d).g+.6*(255-j.rgb(d).g),j.rgb(d).b+.6*(255-j.rgb(d).b)),_=j.rgb(j.rgb(d).r+.8*(255-j.rgb(d).r),j.rgb(d).g+.8*(255-j.rgb(d).g),j.rgb(d).b+.8*(255-j.rgb(d).b)),t=i.getTooltipText(t),f=0,x=0,y=0;null!==a._tooltipGroup&&void 0!==a._tooltipGroup&&a._tooltipGroup.remove(),a._tooltipGroup=a.svg.append("g"),i.p||(n=i._isStacked()?1:h/2,i.x._hasCategories()||null===p.y||a._tooltipGroup.append("line").attr("class","dimple-tooltip-dropline "+a.customClassList.tooltipDropLine).attr("x1",e<i.x._origin?e+n:e+h-n).attr("y1",l<p.y?l+c:l).attr("x2",e<i.x._origin?e+n:e+h-n).attr("y2",l<p.y?l+c:l).call(function(t){a.noFormats||t.style("fill","none").style("stroke",d).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",u)}).transition().delay(375).duration(375).ease(j.easeLinear).attr("y2",l<p.y?p.y-1:p.y+1),n=i._isStacked()?1:c/2,i.y._hasCategories())||null===p.x||a._tooltipGroup.append("line").attr("class","dimple-tooltip-dropline "+a.customClassList.tooltipDropLine).attr("x1",e<p.x?e+h:e).attr("y1",l<i.y._origin?l+n:l+c-n).attr("x2",e<p.x?e+h:e).attr("y2",l<i.y._origin?l+n:l+c-n).call(function(t){a.noFormats||t.style("fill","none").style("stroke",d).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",u)}).transition().delay(375).duration(375).ease(j.easeLinear).attr("x2",e<p.x?p.x-1:p.x+1),p=(n=a._tooltipGroup.append("g")).append("rect").attr("class","dimple-tooltip "+a.customClassList.tooltipBox),n.selectAll(".dimple-dont-select-any").data(t).enter().append("text").attr("class","dimple-tooltip "+a.customClassList.tooltipLabel).text(function(t){return t}).call(function(t){a.noFormats||t.style("font-family",i.tooltipFontFamily).style("font-size",i._getTooltipFontSize())}),n.each(function(){x=this.getBBox().width>x?this.getBBox().width:x,y=this.getBBox().width>y?this.getBBox().height:y}),n.selectAll("text").attr("x",0).attr("y",function(){return(f+=this.getBBox().height)-this.getBBox().height/2}),p.attr("x",-5).attr("y",-5).attr("height",Math.floor(f+5)-.5).attr("width",x+10).attr("rx",5).attr("ry",5).call(function(t){a.noFormats||t.style("fill",_).style("stroke",g).style("stroke-width",2).style("opacity",.95)}),t=s(e+h+5+10+x).x<parseFloat(a.svg.node().getBBox().width)?(r=e+h+5+10,l+c/2-(f-(y-5))/2):0<s(e-(15+x)).x?(r=e-(15+x),l+c/2-(f-(y-5))/2):s(0,l+c+f+10+5).y<parseFloat(a.svg.node().getBBox().height)?(r=(r=0<(r=e+h/2-(10+x)/2)?r:10)+x<parseFloat(a.svg.node().getBBox().width)?r:parseFloat(a.svg.node().getBBox().width)-x-10,l+c+10):(r=(r=0<(r=e+h/2-(10+x)/2)?r:10)+x<parseFloat(a.svg.node().getBBox().width)?r:parseFloat(a.svg.node().getBBox().width)-x-10,l-f-(y-5)),p=s(r,t),n.attr("transform","translate("+p.x+" , "+p.y+")")},R._showPointTooltip=function(t,e,i,s){var a,r,e=j.select(e),n=parseFloat(e.attr("cx")),o=parseFloat(e.attr("cy")),l=parseFloat(e.attr("r")),h=R._helpers.opacity(t,i,s),c=e.attr("stroke"),e=s._dropLineOrigin(),u=j.rgb(j.rgb(c).r+.6*(255-j.rgb(c).r),j.rgb(c).g+.6*(255-j.rgb(c).g),j.rgb(c).b+.6*(255-j.rgb(c).b)),d=j.rgb(j.rgb(c).r+.8*(255-j.rgb(c).r),j.rgb(c).g+.8*(255-j.rgb(c).g),j.rgb(c).b+.8*(255-j.rgb(c).b)),p=0,g=0,_=0,t=s.getTooltipText(t);null!==i._tooltipGroup&&void 0!==i._tooltipGroup&&i._tooltipGroup.remove(),i._tooltipGroup=i.svg.append("g"),i._tooltipGroup.append("circle").attr("class","dimple-line-marker-circle "+i.customClassList.lineMarkerCircle).attr("cx",n).attr("cy",o).attr("r",l).call(function(t){i.noFormats||t.attr("opacity",0).style("fill","none").style("stroke",c).style("stroke-width",1)}).transition().duration(375).ease(j.easeLinear).attr("r",l+s.lineWeight+2).call(function(t){i.noFormats||t.attr("opacity",1).style("stroke-width",2)}),null!==e.y&&i._tooltipGroup.append("line").attr("class","dimple-tooltip-dropline "+i.customClassList.tooltipDropLine).attr("x1",n).attr("y1",o<e.y?o+l+s.lineWeight+2:o-l-s.lineWeight-2).attr("x2",n).attr("y2",o<e.y?o+l+s.lineWeight+2:o-l-s.lineWeight-2).call(function(t){i.noFormats||t.style("fill","none").style("stroke",c).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",h)}).transition().delay(375).duration(375).ease(j.easeLinear).attr("y2",o<e.y?e.y-1:e.y+1),null!==e.x&&i._tooltipGroup.append("line").attr("class","dimple-tooltip-dropline "+i.customClassList.tooltipDropLine).attr("x1",n<e.x?n+l+s.lineWeight+2:n-l-s.lineWeight-2).attr("y1",o).attr("x2",n<e.x?n+l+s.lineWeight+2:n-l-s.lineWeight-2).attr("y2",o).call(function(t){i.noFormats||t.style("fill","none").style("stroke",c).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",h)}).transition().delay(375).duration(375).ease(j.easeLinear).attr("x2",n<e.x?e.x-1:e.x+1),a=(e=i._tooltipGroup.append("g")).append("rect").attr("class","dimple-tooltip "+i.customClassList.tooltipBox),e.selectAll(".dont-select-any").data(t).enter().append("text").attr("class","dimple-tooltip "+i.customClassList.tooltipLabel).text(function(t){return t}).call(function(t){i.noFormats||t.style("font-family",s.tooltipFontFamily).style("font-size",s._getTooltipFontSize())}),e.each(function(){g=this.getBBox().width>g?this.getBBox().width:g,_=this.getBBox().width>_?this.getBBox().height:_}),e.selectAll("text").attr("x",0).attr("y",function(){return(p+=this.getBBox().height)-this.getBBox().height/2}),a.attr("x",-5).attr("y",-5).attr("height",Math.floor(p+5)-.5).attr("width",g+10).attr("rx",5).attr("ry",5).call(function(t){i.noFormats||t.style("fill",d).style("stroke",u).style("stroke-width",2).style("opacity",.95)}),t=n+l+5+10+g<parseFloat(i.svg.node().getBBox().width)?(r=n+l+5+10,o-(p-(_-5))/2):0<n-l-(15+g)?(r=n-l-(15+g),o-(p-(_-5))/2):o+l+p+10+5<parseFloat(i.svg.node().getBBox().height)?(r=(r=0<(r=n-(10+g)/2)?r:10)+g<parseFloat(i.svg.node().getBBox().width)?r:parseFloat(i.svg.node().getBBox().width)-g-10,o+l+10):(r=(r=0<(r=n-(10+g)/2)?r:10)+g<parseFloat(i.svg.node().getBBox().width)?r:parseFloat(i.svg.node().getBBox().width)-g-10,o-p-(_-5)),e.attr("transform","translate("+r+" , "+t+")")},R.filterData=function(t,e,i){var s=t;return null!==e&&null!==i&&(null!=i&&(i=[].concat(i)),s=[],t.forEach(function(t){(null===t[e]||-1<i.indexOf([].concat(t[e]).join("/")))&&s.push(t)},this)),s},R.getUniqueValues=function(t,e){var a=[];return null!=e&&(e=[].concat(e),t.forEach(function(i){var s="";e.forEach(function(t,e){0<e&&(s+="/"),s+=i[t]},this),-1===a.indexOf(s)&&a.push(s)},this)),a},R.newSvg=function(t,e,i){var s=null;if((s=j.select(t=null==t?"body":t)).empty())throw"The '"+t+"' selector did not match any elements.  Please prefix with '#' to select by id or '.' to select by class";return s.append("svg").attr("width",e).attr("height",i)},R});